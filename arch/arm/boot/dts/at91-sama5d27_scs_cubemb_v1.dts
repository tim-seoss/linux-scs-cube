// SPDX-License-Identifier: (GPL-2.0+)
/*
 * at91-sama5d27_scs_cubemb_v1.dts - Device Tree file for South Coast Science Cube Main Board v1
 *
 *  Copyright (C) 2015 Atmel,
 *                2015 Nicolas Ferre <nicolas.ferre@atmel.com>
 *
 *  Copyright (C) 2020 SEOSS Ltd.
 *                2020 Tim Small <tim@seoss.co.uk>
 */
/dts-v1/;
#include "sama5d2.dtsi"
#include "sama5d2-pinfunc.h"
#include <dt-bindings/mfd/atmel-flexcom.h>
#include <dt-bindings/pinctrl/at91.h>
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/mfd/at91-usart.h>
#include <dt-bindings/regulator/active-semi,8945a-regulator.h>

/ {
	model = "South Coast Science Cube MB v1";
	compatible = "scs,sama5-cubemb-v1", "atmel,sama5d2", "atmel,sama5";

	aliases {
		serial0 = &uart0;	/* UART0 is connected to J16+J18 (NC) default  (J8 selectable with links) */
		serial1 = &uart1;       /* UART1 is connected to the FTDI USB <-> UART onboard and to J17 DBGU */
		serial2 = &uart2;       /* UART2 is connected to the stm32 */
		serial3 = &uart3;	/* UART3 is connected to J8 default (J16+J18 selectable with links) */
		i2c0    = &i2c0;
		i2c1    = &i2c1;
		i2c5    = &i2c5;
		/* spi0	= &spi6; */  /* flexcom4 SPI mode */
		/* spi0	= &uart9; */ /* flexcom4 USART mode */
		/* spi0	= &flx4_spi; */
		/* spi0	= &flx4_uart_spi; */
		spi0	= &usart_flx4;
		spi1	= &spi0;
        };

	chosen {
		stdout-path = "serial1:115200n8";
	};

	clocks {
		slow_xtal {
			clock-frequency = <32768>;
		};

		main_xtal {
			clock-frequency = <12000000>;
		};
	};

	ahb {
		usb0: gadget@300000 {
			atmel,vbus-gpio = <&pioA PIN_PA31 GPIO_ACTIVE_HIGH>;  // USBB_5V_PRES FIXME check this vs SOM?
			pinctrl-names = "default";
			pinctrl-0 = <&pinctrl_usba_vbus>;
			status = "okay";
		};

		usb1: ohci@400000 {
			num-ports = <3>;
			atmel,vbus-gpio = <0 
					   &pioA PIN_PB10 GPIO_ACTIVE_HIGH // signal USBA_EN5V
					   0
					  >;
			pinctrl-names = "default";
			pinctrl-0 = <&pinctrl_usb_default>;
			status = "okay";
		};

		usb2: ehci@500000 {
			status = "okay";
		};

		sdmmc0: sdio-host@a0000000 {
			bus-width = <8>;
			pinctrl-names = "default";
			pinctrl-0 = <&pinctrl_sdmmc0_default>;
			non-removable;
			mmc-ddr-1_8v;
			status = "okay";
		};

		sdmmc1: sdio-host@b0000000 {
			bus-width = <4>;
			pinctrl-names = "default";
			pinctrl-0 = <&pinctrl_sdmmc1_default>;
			status = "okay";
			/* TODO check with Jamie why this was commented out in his 49 dts? 
			   FIXME check cube MB schematic vs. sama5d2_xplained schematic
			vqmmc-supply = <&vdd_3v3_reg>;
			vmmc-supply = <&vdd_3v3_reg>;
			*/
		};

		apb {
			spi0: spi@f8000000 {
				pinctrl-names = "default";
				/* Function A  PA14 SPCK, PA15 MOSI, PA16 MISO, PA17 NPCS0  */
				/* pinctrl-0 = <&pinctrl_spi0_default>; */
				cs-gpios = <&pioA PIN_PA17 GPIO_ACTIVE_LOW>, <0>, <0>, <0>;
				/* defualt (low?) drive strength: */
				/* pinctrl-0 = <&pinctrl_spi0_def_nocs &pinctrl_spi0_cs>; */
				/* explicit drive for miso and ck pins */
				pinctrl-0 = <&pinctrl_spi0_ck_drv &pinctrl_spi0_mosi_drv &pinctrl_spi0_miso &pinctrl_spi0_cs>;
				status = "okay";

				/* This bus connected to external connector J6 */
				con_j6@0 {
					compatible = "scs,cube_mb_v1_j6";
					reg = <0>;
					spi-max-frequency = <50000000>;
				};
			};

			/* SPI1 signals are NC in this board revision         */
			spi1: spi@fc000000 {                            
				pinctrl-names = "default";              
				pinctrl-0 = <&pinctrl_spi1_default>;    
				status = "disabled";                        

				spidev1: spidev@0 {
					/* compatible = "";   // Currently NC */        
					reg = <0>;                      
					spi-max-frequency = <50000000>; 
				};                                      
			};                                              	

			/* FLEXCOM no. 3 SoC interface configured as i2c, with pins *
			 * clock: PC19, SDA: PC20.                                  *
			 * Jumper links (cur. unpopulated) make this avail on J10   */
			
			flx3: flexcom@fc014000 {
				atmel,flexcom-mode = <ATMEL_FLEXCOM_MODE_TWI>;
				status = "okay";

				i2c5: i2c@600 {
					compatible = "atmel,sama5d2-i2c";
					pinctrl-names = "default", "gpio";
					pinctrl-0 = <&pinctrl_flx3_i2c_pc20_pc19>;
					pinctrl-1 = <&pinctrl_flx3_i2c_pc20_pc19_gpio>;
					sda-gpios = <&pioA PIN_PC20 GPIO_ACTIVE_HIGH>;
					scl-gpios = <&pioA PIN_PC19 (GPIO_ACTIVE_HIGH | GPIO_OPEN_DRAIN)>;
					status = "okay";
				};
			};

			/* FIXME use new definitions from sama5d2.dtsi and just set pinctrl and status = okay */

			/* External SPI connector J12 ("FLEXCOM" no. 4 SoC interface   *
			 * pins PA28 to PA31 (Func B)                                  *
			 * Modifies flx4 definitions from sama5d2.dtsi                 *
			 * See Documentation/devicetree/bindings/mfd/atmel-flexcom.txt */
			flx4: flexcom@fc018000 {
				atmel,flexcom-mode = <ATMEL_FLEXCOM_MODE_USART>;
				status = "okay";

				spi6: spi@400 {
					#address-cells = <1>;
					#size-cells = <0>;
					//status = "okay";

					/* use spi usart driver instead */
					/* use spi usart driver instead */
					/* use spi usart driver instead */
					/* use spi usart driver instead */
					status = "disabled";

					pinctrl-names = "default";
					pinctrl-0 = <&pinctrl_flx4_spi_pc28_pc31>;
					//cs-gpios = <&pioA PIN_PC31 GPIO_ACTIVE_LOW>, <0>, <0>, <0>;
					cs-gpios = <&pioA PIN_PC31 GPIO_ACTIVE_LOW>;

					// This SPI bus brought out onto external connector J12
					con_j12@0 {
						compatible = "scs,cube_mb_v1_j12";
						reg = <0>;
						spi-max-frequency = <50000000>;
					};
				};

				usart_flx4: spi@200 { // n.b. USART peripheral utilised as SPI master.
					#address-cells = <1>;
					#size-cells = <0>;

					compatible = "atmel,at91rm9200-usart", "atmel,at91sam9260-usart", "at91_usart_spi";

					atmel,usart-mode = <AT91_USART_MODE_SPI>;
					pinctrl-names = "default";
					pinctrl-0 = <&pinctrl_flx4_spi_pc28_pc31>;
					reg = <0x200 0x200>;
					interrupts = <23 IRQ_TYPE_LEVEL_HIGH 7>;
					clocks = <&pmc PMC_TYPE_PERIPHERAL 23>;
					clock-names = "usart";
					dmas = <&dma0
						(AT91_XDMAC_DT_MEM_IF(0) |
						 AT91_XDMAC_DT_PER_IF(1) |
						 AT91_XDMAC_DT_PERID(19))>,
					       <&dma0
						(AT91_XDMAC_DT_MEM_IF(0) |
						 AT91_XDMAC_DT_PER_IF(1) |
						 AT91_XDMAC_DT_PERID(20))>;
					dma-names = "tx", "rx";
					atmel,fifo-size = <32>;
					cs-gpios = <&pioA PIN_PC31 GPIO_ACTIVE_LOW>;
					status = "okay";

					/* spi@0 {
						compatible = "microchip,at91sam9g45-usart-spi";
						reg = <0>;
					}; */

					con_j12@0 {
						compatible = "scs,cube_mb_v1_j12";
						reg = <0>;
						spi-max-frequency = <50000000>;
					};
				};

/*				flx4_spi: spi@400 {
					compatible = "atmel,at91rm9200-spi";
					reg = <0x400 0x200>;  // reg offset and length for spi peripheral within flexcom device
					// PID for FLEXCOM4 is 23, high level triggered, priority is 7
					// used to configure FLEXCOM4 interrupt in AIC
					interrupts = <23 IRQ_TYPE_LEVEL_HIGH 7>;
					#address-cells = <1>;
					#size-cells = <0>;
					dmas = <&dma0
					(AT91_XDMAC_DT_MEM_IF(0) | AT91_XDMAC_DT_PER_IF(1) |
					 AT91_XDMAC_DT_PERID(19))>,
					<&dma0
					(AT91_XDMAC_DT_MEM_IF(0) | AT91_XDMAC_DT_PER_IF(1) |
					 AT91_XDMAC_DT_PERID(20))>;
					dma-names = "tx", "rx";
					clocks = <&pmc PMC_TYPE_PERIPHERAL 23>;
					clock-names = "spi_clk";
					pinctrl-names = "default";
					pinctrl-0 = <&pinctrl_flx4_spi_pc28_pc31>;
					atmel,fifo-size = <16>;
					// status = "disabled"; //  use spi usart driver instead
					status = "okay";

					con_j12@0 {                     
						compatible = "scs,cube_mb_v1_j12";
						reg = <0>;
						spi-max-frequency = <50000000>; 
					};

				}; 
/*

/*				uart9: serial@200 {
					compatible = "atmel,at91sam9260-usart";
					reg = <0x200 0x200>;
					interrupts = <23 IRQ_TYPE_LEVEL_HIGH 7>;
					clocks = <&pmc PMC_TYPE_PERIPHERAL 23>;
					clock-names = "usart";
					dmas = <&dma0
						(AT91_XDMAC_DT_MEM_IF(0) |
						 AT91_XDMAC_DT_PER_IF(1) |
						 AT91_XDMAC_DT_PERID(19))>,
					       <&dma0
						(AT91_XDMAC_DT_MEM_IF(0) |
						 AT91_XDMAC_DT_PER_IF(1) |
						 AT91_XDMAC_DT_PERID(20))>;
					dma-names = "tx", "rx";
					atmel,fifo-size = <32>;
					status = "disabled";
				}; */

/*				flx4_usart_spi: usart_spi@200 {
					compatible = "atmel,at91rm9200-usart", "atmel,at91sam9260-usart";
					atmel,usart-mode = <AT91_USART_MODE_SPI>;
					reg = <0x200 0x200>;
				}; */

				i2c@600 {
					status = "disabled";
				};
			};

			macb0: ethernet@f8008000 {
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_macb0_default &pinctrl_macb0_phy_irq>;
				phy-mode = "rmii";
				status = "okay";

				ethernet-phy@1 {
					reg = <0x1>;
					interrupt-parent = <&pioA>;
					interrupts = <PIN_PC9 IRQ_TYPE_LEVEL_LOW>;
				};
			};

			/* n.b. FIXME, review. This tcb block absent from Jamie's 4.19.x device table */
			tcb0: timer@f800c000 {
				timer0: timer@0 {
					compatible = "atmel,tcb-timer";
					reg = <0>;
				};

				timer1: timer@1 {
					compatible = "atmel,tcb-timer";
					reg = <1>;
				};
			};
			uart0: serial@f801c000 {
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_uart0_default>;
				atmel,use-dma-rx;
				atmel,use-dma-tx;
				status = "okay";
			};

			uart1: serial@f8020000 {
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_uart1_default>;
				atmel,use-dma-rx;
				atmel,use-dma-tx;
				status = "okay";
			};

			uart2: serial@f8024000 {
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_uart2_default>;
				atmel,use-dma-rx;
				atmel,use-dma-tx;
				status = "okay";
			};


			/* I2C0 connected to PMIC only (not brought out to external connectors) */
			i2c0: i2c@f8028000 {
				dmas = <0>, <0>;
				pinctrl-names = "default", "gpio";
				pinctrl-0 = <&pinctrl_i2c0_default>;
				pinctrl-1 = <&pinctrl_i2c0_gpio>;
				sda-gpios = <&pioA PIN_PD21 GPIO_ACTIVE_HIGH>;
				scl-gpios = <&pioA PIN_PD22 (GPIO_ACTIVE_HIGH | GPIO_OPEN_DRAIN)>;
				i2c-sda-hold-time-ns = <350>;
				status = "okay";

				pmic@5b {
					compatible = "active-semi,act8945a";
					reg = <0x5b>;
					active-semi,vsel-high;
					status = "okay";

					regulators {
						vdd_1v35_reg: REG_DCDC1 {
							regulator-name = "VDD_1V35";
							regulator-min-microvolt = <1350000>;
							regulator-max-microvolt = <1350000>;
							regulator-allowed-modes = <ACT8945A_REGULATOR_MODE_FIXED>,
										  <ACT8945A_REGULATOR_MODE_LOWPOWER>;
							regulator-initial-mode = <ACT8945A_REGULATOR_MODE_FIXED>;
							regulator-always-on;

							regulator-state-mem {
								regulator-on-in-suspend;
								regulator-suspend-min-microvolt=<1400000>;
								regulator-suspend-max-microvolt=<1400000>;
								regulator-changeable-in-suspend;
								regulator-mode=<ACT8945A_REGULATOR_MODE_LOWPOWER>;
							};
						};

						vdd_1v2_reg: REG_DCDC2 {
							regulator-name = "VDD_1V2";
							regulator-min-microvolt = <1100000>;
							regulator-max-microvolt = <1300000>;
							regulator-allowed-modes = <ACT8945A_REGULATOR_MODE_FIXED>,
										  <ACT8945A_REGULATOR_MODE_LOWPOWER>;
							regulator-initial-mode = <ACT8945A_REGULATOR_MODE_FIXED>;
							regulator-always-on;

							regulator-state-mem {
								regulator-off-in-suspend;
							};
						};

						vdd_3v3_reg: REG_DCDC3 {
							regulator-name = "VDD_3V3";
							regulator-min-microvolt = <3300000>;
							regulator-max-microvolt = <3300000>;
							regulator-allowed-modes = <ACT8945A_REGULATOR_MODE_FIXED>,
										  <ACT8945A_REGULATOR_MODE_LOWPOWER>;
							regulator-initial-mode = <ACT8945A_REGULATOR_MODE_FIXED>;
							regulator-always-on;

							regulator-state-mem {
								regulator-off-in-suspend;
							};
						};

						vdd_fuse_reg: REG_LDO1 {
							regulator-name = "VDD_FUSE";
							regulator-min-microvolt = <2500000>;
							regulator-max-microvolt = <2500000>;
							regulator-allowed-modes = <ACT8945A_REGULATOR_MODE_NORMAL>,
										  <ACT8945A_REGULATOR_MODE_LOWPOWER>;
							regulator-initial-mode = <ACT8945A_REGULATOR_MODE_NORMAL>;
							regulator-always-on;

							regulator-state-mem {
								regulator-off-in-suspend;
							};
						};

						vdd_3v3_lp_reg: REG_LDO2 {
							regulator-name = "VDD_3V3_LP";
							regulator-min-microvolt = <3300000>;
							regulator-max-microvolt = <3300000>;
							regulator-allowed-modes = <ACT8945A_REGULATOR_MODE_NORMAL>,
										  <ACT8945A_REGULATOR_MODE_LOWPOWER>;
							regulator-initial-mode = <ACT8945A_REGULATOR_MODE_NORMAL>;
							regulator-always-on;

							regulator-state-mem {
								regulator-off-in-suspend;
							};
						};

						vdd_led_reg: REG_LDO3 {
							regulator-name = "VDD_LED";
							regulator-min-microvolt = <3300000>;
							regulator-max-microvolt = <3300000>;
							regulator-allowed-modes = <ACT8945A_REGULATOR_MODE_NORMAL>,
										  <ACT8945A_REGULATOR_MODE_LOWPOWER>;
							regulator-initial-mode = <ACT8945A_REGULATOR_MODE_NORMAL>;
							regulator-always-on;

							regulator-state-mem {
								regulator-off-in-suspend;
							};
						};

						vdd_sdhc_1v8_reg: REG_LDO4 {
							regulator-name = "VDD_SDHC_1V8";
							regulator-min-microvolt = <1800000>;
							regulator-max-microvolt = <1800000>;
							regulator-allowed-modes = <ACT8945A_REGULATOR_MODE_NORMAL>,
										  <ACT8945A_REGULATOR_MODE_LOWPOWER>;
							regulator-initial-mode = <ACT8945A_REGULATOR_MODE_NORMAL>;
							regulator-always-on;

							regulator-state-mem {
								regulator-off-in-suspend;
							};
						};
					};

					charger {
						compatible = "active-semi,act8945a-charger";
						pinctrl-names = "default";
						pinctrl-0 = <&pinctrl_charger_chglev &pinctrl_charger_lbo &pinctrl_charger_irq>;
						interrupt-parent = <&pioA>;
						interrupts = <PIN_PB13 IRQ_TYPE_EDGE_RISING>;

						active-semi,chglev-gpios = <&pioA PIN_PA12 GPIO_ACTIVE_HIGH>;
						active-semi,lbo-gpios = <&pioA PIN_PC8 GPIO_ACTIVE_LOW>;
						active-semi,input-voltage-threshold-microvolt = <6600>;
						active-semi,precondition-timeout = <40>;
						active-semi,total-timeout = <3>;
						status = "okay";
					};
				};
			};

			shdwc@f8048010 {
				atmel,shdwc-debouncer = <976>;
				atmel,wakeup-rtc-timer;

				input@0 {
					reg = <0>;
					atmel,wakeup-type = "low";
				};
			};

			watchdog@f8048040 {
				status = "okay";
			};

			uart3: serial@fc008000 {
				atmel,use-dma-rx;
				atmel,use-dma-tx;
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_uart3_default>;
				status = "okay";
			};

			/* I2C1 connected to J7, J9, J10 (resistor links default), J11, MCU, 24AA02 */
			/* I2C resistor links to J10 */
			i2c1: i2c@fc028000 {
				dmas = <0>, <0>;
				pinctrl-names = "default", "gpio";
				pinctrl-0 = <&pinctrl_i2c1_default>;
				i2c-analog-filter;
				i2c-digital-filter;
				i2c-digital-filter-width-ns = <35>;
				pinctrl-1 = <&pinctrl_i2c1_gpio>;
				sda-gpios = <&pioA PIN_PD4 GPIO_ACTIVE_HIGH>;
				scl-gpios = <&pioA PIN_PD5 (GPIO_ACTIVE_HIGH | GPIO_OPEN_DRAIN)>;
				status = "okay";

				/* 24AA02E48T-I/OT 2 Kbit, 8-byte page, IÂ²C EEPROM with EUI-48 Node Identity */
				/* n.b. This responds on addresses 0x50 to 0x57 */
				eui48eeprom: eeprom@50 {
					compatible = "atmel,24c02", "microchip,24aa02e48";
					reg = <0x50>;
					pagesize = <8>;
				};
			};

			pinctrl@fc038000 {

				pinctrl_charger_chglev: charger_chglev {
					pinmux = <PIN_PA12__GPIO>;
					bias-disable;
				};

				pinctrl_charger_irq: charger_irq {
					pinmux = <PIN_PB13__GPIO>;
					bias-disable;
				};

				pinctrl_charger_lbo: charger_lbo {
					pinmux = <PIN_PC8__GPIO>;
					bias-pull-up;
				};


/* FIXME add flexcom3 i2c gpio */
				pinctrl_flx3_i2c_pc20_pc19: flx3_i2c_pc20_pc19 {
					pinmux = <PIN_PC20__FLEXCOM3_IO0>,
						 <PIN_PC19__FLEXCOM3_IO1>;
					bias-disable;
				};

				pinctrl_flx3_i2c_pc20_pc19_gpio: flx3_i2c_pc20_pc19 {
					pinmux = <PIN_PC20__GPIO>,
						 <PIN_PC19__GPIO>;
					bias-disable;
				};

				/* Flexcom 4 IO Set 1, function B - ref SAMA5D2 Series Datasheet Section 6.2 Pinouts */
				pinctrl_flx4_spi_pc28_pc31: flx4_spi_pc28_pc31 {
					pinmux = <PIN_PC28__FLEXCOM4_IO0>,  /* SPI MOSI */
						 <PIN_PC29__FLEXCOM4_IO1>,  /* SPI MISO */
						 <PIN_PC30__FLEXCOM4_IO2>,  /* SPI SPCK */
						 <PIN_PC31__FLEXCOM4_IO3>;  /* PC31 is used for CS0 - FIXME Check */
					bias-disable;
				};

				pinctrl_i2c0_default: i2c0_default {
					pinmux = <PIN_PD21__TWD0>,
						 <PIN_PD22__TWCK0>;
					bias-disable;
				};

				pinctrl_i2c0_gpio: i2c0_gpio {
					pinmux = <PIN_PD21__GPIO>,
						 <PIN_PD22__GPIO>;
					bias-disable;
				};

				pinctrl_i2c1_default: i2c1_default {
					pinmux = <PIN_PD4__TWD1>,
						 <PIN_PD5__TWCK1>;
					bias-disable;
				};

				pinctrl_i2c1_gpio: i2c1_gpio {
					pinmux = <PIN_PD4__GPIO>,
						 <PIN_PD5__GPIO>;
					bias-disable;
				};


				pinctrl_key_gpio_default: key_gpio_default {
					pinmux = <PIN_PB9__GPIO>;
					bias-pull-up;
				};

				pinctrl_led_gpio_default: led_gpio_default {
					pinmux = <PIN_PB0__GPIO>,
						 <PIN_PB5__GPIO>,
						 <PIN_PB6__GPIO>;
					bias-pull-up;
				};

				pinctrl_macb0_default: macb0_default {
					pinmux = <PIN_PB14__GTXCK>,
						 <PIN_PB15__GTXEN>,
						 <PIN_PB16__GRXDV>,
						 <PIN_PB17__GRXER>,
						 <PIN_PB18__GRX0>,
						 <PIN_PB19__GRX1>,
						 <PIN_PB20__GTX0>,
						 <PIN_PB21__GTX1>,
						 <PIN_PB22__GMDC>,
						 <PIN_PB23__GMDIO>;
					bias-disable;
				};

				pinctrl_macb0_phy_irq: macb0_phy_irq {
					pinmux = <PIN_PC9__GPIO>;
					bias-disable;
				};

				pinctrl_sdmmc0_default: sdmmc0_default {
					cmd_data {
						pinmux = <PIN_PA1__SDMMC0_CMD>,
							 <PIN_PA2__SDMMC0_DAT0>,
							 <PIN_PA3__SDMMC0_DAT1>,
							 <PIN_PA4__SDMMC0_DAT2>,
							 <PIN_PA5__SDMMC0_DAT3>,
							 <PIN_PA6__SDMMC0_DAT4>,
							 <PIN_PA7__SDMMC0_DAT5>,
							 <PIN_PA8__SDMMC0_DAT6>,
							 <PIN_PA9__SDMMC0_DAT7>;
						bias-disable;
					};

					ck_cd_rstn_vddsel {
						pinmux = <PIN_PA0__SDMMC0_CK>,
							 <PIN_PA10__SDMMC0_RSTN>,
							 <PIN_PA11__SDMMC0_VDDSEL>,
							 <PIN_PA13__SDMMC0_CD>;
						bias-disable;
					};
				};

				pinctrl_sdmmc1_default: sdmmc1_default {
					cmd_data {
						pinmux = <PIN_PA28__SDMMC1_CMD>,
							 <PIN_PA18__SDMMC1_DAT0>,
							 <PIN_PA19__SDMMC1_DAT1>,
							 <PIN_PA20__SDMMC1_DAT2>,
							 <PIN_PA21__SDMMC1_DAT3>;
						bias-disable;
					};

					conf-ck_cd {
						pinmux = <PIN_PA22__SDMMC1_CK>,
							 <PIN_PA30__SDMMC1_CD>;
						bias-disable;
					};
				};

				pinctrl_spi0_default: spi0_default {
					pinmux = <PIN_PA14__SPI0_SPCK>,
						 <PIN_PA15__SPI0_MOSI>,
						 <PIN_PA16__SPI0_MISO>,
						 <PIN_PA17__SPI0_NPCS0>;
					bias-disable;
				};

				pinctrl_spi0_def_nocs: spi0_def_nocs {
					pinmux = <PIN_PA14__SPI0_SPCK>,
						 <PIN_PA15__SPI0_MOSI>,
						 <PIN_PA16__SPI0_MISO>;
					bias-disable;
				};

				pinctrl_spi0_ck_drv: spi0_def_ck_drv {
					pinmux = <PIN_PA14__SPI0_SPCK>;
					bias-disable;
					atmel,drive-strength = <ATMEL_PIO_DRVSTR_ME>;
				};

				pinctrl_spi0_mosi_drv: spi0_mosi_drv {
					pinmux = <PIN_PA15__SPI0_MOSI>;
					bias-disable;
					atmel,drive-strength = <ATMEL_PIO_DRVSTR_ME>;
				};

				pinctrl_spi0_miso: spi0_miso {
					pinmux = <PIN_PA16__SPI0_MISO>;
					bias-disable;
				};

				pinctrl_spi0_cs: spi0_cs {

					pinmux = <PIN_PA17__SPI0_NPCS0>;
					bias-disable;
				};

				/* START review Block added by Jamie to his 4-19 kernel device tree */
				pinctrl_spi1_default: spi1_default {   
					pinmux = <PIN_PC1__SPI1_SPCK>, 
						 <PIN_PC2__SPI1_MOSI>, 
						 <PIN_PC3__SPI1_MISO>, 
						 <PIN_PC4__SPI1_NPCS0>;
					bias-disable;                  
				};                                     
								       
				pinctrl_uart0_default: uart0_default { 
					pinmux = <PIN_PB26__URXD0>,    
						 <PIN_PB27__UTXD0>;    
					bias-disable;                  
				};                                     
				/* END review Block added by Jamie to his 4-19 kernel device tree */

				pinctrl_uart1_default: uart1_default {
					pinmux = <PIN_PD2__URXD1>,
						 <PIN_PD3__UTXD1>;
					bias-disable;
				};

				/* START review Block added by Jamie to his 4-19 kernel device tree */
				pinctrl_uart2_default: uart2_default {
					pinmux = <PIN_PD23__URXD2>,   
						 <PIN_PD24__UTXD2>;   
					bias-disable;                 
				};                                    
				/* END review Block added by Jamie to his 4-19 kernel device tree */

				pinctrl_uart3_default: uart3_default {
					pinmux = <PIN_PB11__URXD3>,
						 <PIN_PB12__UTXD3>;
					bias-disable;
				};

				/* FIXME FIXME check this  */
				pinctrl_usb_default: usb_default {
					/* pinmux line changed (by Jamie?) */
					/* pinmux = <PIN_PB10__GPIO>; */
					pinmux = <PIN_PA31__GPIO>;
					bias-disable;
				};

				/* FIXME FIXME check this  */
				pinctrl_usba_vbus: usba_vbus {
					/* pinmux line changed (by Jamie?) */
					/* pinmux = <PIN_PA31__GPIO>; */
					pinmux = <PIN_PB10__GPIO>;
					/* FIXME PA29 is connected to USBA over current signal */
/*
							<PIN_PA29_GPIO>;
*/
					bias-disable;
				};
			};
		};
	};

	leds {
		compatible = "gpio-leds";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_led_gpio_default>;
		status = "okay";

		red {
			label = "red";
			gpios = <&pioA PIN_PB0 GPIO_ACTIVE_LOW>;
			linux,default-trigger = "heartbeat";
		};
	};
};
